var G=Object.defineProperty,H=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var L=(e,u,n)=>u in e?G(e,u,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[u]=n,N=(e,u)=>{for(var n in u||(u={}))P.call(u,n)&&L(e,n,u[n]);if(V)for(var n of V(u))Q.call(u,n)&&L(e,n,u[n]);return e},O=(e,u)=>H(e,J(u));import{_ as W,p as U,i as X,j as Y}from"./index.353524b8.js";import{u as Z,a as ee,c as ae}from"./table.11835550.js";import{a as m,M as g,d as ue,e as ne,r as l,o as p,g as M,j as r,m as o,F as K,N as S,c as b,as as $,O as F,P as R,h as oe,k as j,n as te,aa as le,L as de}from"./vendor.98fdfd48.js";const q="ROLE_",h=[{label:"\u89D2\u8272\u540D\u79F0",type:"input",key:"name",value:m(""),required:!0,placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u540D\u79F0",validator:function(){return this.value.value?!0:(g.error(this.placeholder||""),!1)}},{label:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",value:m(""),type:"input",required:!0,placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u7F16\u53F7",validator:function(){return this.value.value?!0:(g.error(this.placeholder||""),!1)}},{label:"\u89D2\u8272\u63CF\u8FF0",key:"description",value:m(""),type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u89D2\u8272\u63CF\u8FF0"}];function z(e,u,n){const k=[];return e.forEach(f=>{const i={};i.key=f.menuUrl,i.title=f.menuName,u.push(i.key),f.children&&(n.push(i.key),i.children=z(f.children,u,n)),k.push(i)}),k}const se=ue({name:"Role",setup(){const e=m(null),u=m(null),n=Z(),k=ae("id"),f=m("\u6DFB\u52A0\u89D2\u8272"),i=m([]),A=ee([n.indexColumn,{title:"\u89D2\u8272\u540D\u79F0",key:"name",dataIndex:"name"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",dataIndex:"roleCode"},{title:"\u89D2\u8272\u63CF\u8FF0",key:"description",dataIndex:"description"},{title:"\u521B\u5EFA\u65F6\u95F4",key:"createTime",dataIndex:"createTime"},{title:"\u89D2\u8272\u7F16\u53F7",key:"roleCode",dataIndex:"roleCode"},{title:"\u64CD\u4F5C",key:"actions",dataIndex:"actions"}]),v=m([]),y=m([]);function _(){U({url:X,data:{}}).then(n.handleSuccess).catch(console.log)}function B(){var d;f.value="\u6DFB\u52A0\u89D2\u8272",(d=e.value)==null||d.toggle(),h.forEach(t=>{t.reset?t.reset():t.value.value=""})}function I(d){var t;f.value="\u7F16\u8F91\u89D2\u8272",(t=e.value)==null||t.toggle(),le(()=>{h.forEach(c=>{const C=c.key,D=d[C];D&&(c.key==="roleCode"?c.value.value=D.replace(q,""):c.value.value=D)})})}function w(d){de.confirm({title:"\u63D0\u793A",content:"\u662F\u5426\u8981\u5220\u9664\u6B64\u89D2\u8272\uFF1F",cancelText:"\u53D6\u6D88",okText:"\u5220\u9664",onOk:()=>{g.success("\u6A21\u62DF\u89D2\u8272\u5220\u9664\u6210\u529F\uFF0C\u53C2\u6570\u4E3A"+JSON.stringify(d))}})}function x(){var d;h.every(t=>t.validator?t.validator():!0)&&((d=e.value)==null||d.toggle(),g.success("\u6A21\u62DF\u83DC\u5355\u6DFB\u52A0\u6210\u529F\uFF0C\u53C2\u6570\u4E3A\uFF1A"+JSON.stringify(h.reduce((t,c)=>(t[c.key]=c.value.value,t),{}))))}function E(d){U({url:Y,data:{roleId:d.id}}).then(t=>{var c;i.value=[],v.value=[],y.value=[],i.value=z(t.data,v.value,y.value),(c=u.value)==null||c.toggle()}).catch(console.log)}return ne(_),O(N({ROLE_CODE_FLAG:q,modalDialogRef:e,menuModalDialogRef:u,rowKey:k,menuData:i,tableColumns:A,formItems:h,actionTitle:f,defaultCheckedKeys:v,defaultExpandedKeys:y},n),{onAddItem:B,onDataFormConfirm:x,onShowMenu:E,onDeleteItem:w,onUpdateItem:I})}}),re={class:"main-container"};function ce(e,u,n,k,f,i){const A=l("AddButton"),v=l("TableHeader"),y=l("a-avatar"),_=l("a-button"),B=l("a-space"),I=l("a-table-column"),w=l("a-table"),x=l("TableBody"),E=l("a-input"),d=l("a-textarea"),t=l("a-form-item"),c=l("a-form"),C=l("ModalDialog"),D=l("a-tree");return p(),M("div",re,[r(x,null,{header:o(()=>[r(v,{"show-filter":!1},{"top-right":o(()=>[r(A,{onAdd:e.onAddItem},null,8,["onAdd"])]),_:1})]),default:o(()=>[r(w,{bordered:!1,loading:e.tableLoading,data:e.dataList,pagination:!1,"row-key":e.rowKey},{columns:o(()=>[(p(!0),M(K,null,S(e.tableColumns,a=>(p(),b(I,{key:a.key,align:a.align,title:a.title,width:a.width,"data-index":a.key,fixed:a.fixed},$({_:2},[a.key==="index"?{name:"cell",fn:o(({rowIndex:s})=>[F(R(s+1),1)])}:a.key==="gender"?{name:"cell",fn:o(({record:s})=>[F(R(s.gender===1?"\u7537":"\u5973"),1)])}:a.key==="avatar"?{name:"cell",fn:o(({record:s})=>[r(y,null,{default:o(()=>[oe("img",{src:s.avatar},null,8,["src"])]),_:2},1024)])}:a.key==="actions"?{name:"cell",fn:o(({record:s})=>[r(B,null,{default:o(()=>[r(_,{status:"success",size:"mini",onClick:T=>e.onUpdateItem(s)},{default:o(()=>[F("\u7F16\u8F91")]),_:2},1032,["onClick"]),r(_,{status:"danger",size:"mini",onClick:T=>e.onDeleteItem(s)},{default:o(()=>[F("\u5220\u9664")]),_:2},1032,["onClick"]),r(_,{status:"warning",size:"mini",onClick:T=>e.onShowMenu(s)},{default:o(()=>[F(" \u83DC\u5355\u6743\u9650 ")]),_:2},1032,["onClick"])]),_:2},1024)])}:void 0]),1032,["align","title","width","data-index","fixed"]))),128))]),_:1},8,["loading","data","row-key"])]),_:1}),r(C,{ref:"modalDialogRef",title:e.actionTitle,onConfirm:e.onDataFormConfirm},{content:o(()=>[r(c,null,{default:o(()=>[(p(!0),M(K,null,S(e.formItems,a=>(p(),b(t,{class:te([a.required?"form-item__require":"form-item__no_require"]),label:a.label,key:a.key},{default:o(()=>[a.type==="input"?(p(),b(E,{key:0,placeholder:a.placeholder,modelValue:a.value.value,"onUpdate:modelValue":s=>a.value.value=s},$({_:2},[a.key==="roleCode"?{name:"prepend",fn:o(()=>[F(R(e.ROLE_CODE_FLAG),1)])}:void 0]),1032,["placeholder","modelValue","onUpdate:modelValue"])):j("v-if",!0),a.type==="textarea"?(p(),b(d,{key:1,modelValue:a.value.value,"onUpdate:modelValue":s=>a.value.value=s,placeholder:a.placeholder,"auto-size":{minRows:3,maxRows:5}},null,8,["modelValue","onUpdate:modelValue","placeholder"])):j("v-if",!0)]),_:2},1032,["class","label"]))),128))]),_:1})]),_:1},8,["title","onConfirm"]),r(C,{ref:"menuModalDialogRef",title:"\u7F16\u8F91\u83DC\u5355\u6743\u9650"},{content:o(()=>[r(D,{data:e.menuData,checkable:"","expanded-keys":e.defaultExpandedKeys,"onUpdate:expanded-keys":u[0]||(u[0]=a=>e.defaultExpandedKeys=a),"checked-keys":e.defaultCheckedKeys,"onUpdate:checked-keys":u[1]||(u[1]=a=>e.defaultCheckedKeys=a)},null,8,["data","expanded-keys","checked-keys"])]),_:1},512)])}var Fe=W(se,[["render",ce]]);export{Fe as default};
