var S=Object.defineProperty,q=Object.defineProperties;var z=Object.getOwnPropertyDescriptors;var I=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var M=(e,t,a)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,V=(e,t)=>{for(var a in t||(t={}))G.call(t,a)&&M(e,a,t[a]);if(I)for(var a of I(t))H.call(t,a)&&M(e,a,t[a]);return e},L=(e,t)=>q(e,z(t));import{p as J,_ as Q,f as W}from"./index.353524b8.js";import{u as X,a as Y,c as Z}from"./table.11835550.js";import{d as x,l as ee,a as v,e as te,r as d,o as f,g as k,j as o,m as n,F as w,N as T,c as U,as as ae,O as p,P as j,L as ue,M as O}from"./vendor.98fdfd48.js";import{_ as $}from"./lodash.83282ab2.js";function oe(){return J}const ne="dp_code_",le=x({name:"Department",setup(){const e=X(),t=Y([{title:"\u90E8\u95E8\u540D\u79F0",key:"name",dataIndex:"name"},{title:"\u90E8\u95E8\u7F16\u53F7",key:"depCode",dataIndex:"depCode"},{title:"\u6392\u5E8F",key:"order",dataIndex:"order"},{title:"\u72B6\u6001",key:"status",dataIndex:"status"},{title:"\u64CD\u4F5C",key:"actions",dataIndex:"actions"}]),a=ee({parentId:void 0,id:0,name:"",depCode:"",order:1,status:1}),E=v(),c=v(),A=Z("id"),i=v(null),g=oe();function _(){g({url:W}).then(({data:l=[]})=>(e.tableLoading.value=!1,e.dataList.length=0,e.dataList.push(...l),l))}function F(l,s){for(let r=0;r<l.length;r++){const m=l[r];if(m.id===s.id){if(!$.isEmpty(m.children)){O.error("\u5F53\u524D\u90E8\u95E8\u4E0B\u6709\u5B50\u90E8\u95E8\uFF0C\u4E0D\u80FD\u5220\u9664");return}l.splice(r,1);return}else $.isEmpty(m.children)||F(m.children,s)}}const b=l=>{ue.confirm({title:"\u63D0\u793A",content:"\u786E\u5B9A\u8981\u5220\u9664\u6B64\u4FE1\u606F\uFF0C\u5220\u9664\u540E\u4E0D\u53EF\u6062\u590D\uFF1F",onOk(){F(e.dataList,l)}})};function C(){var l;c.value="\u6DFB\u52A0\u90E8\u95E8",a.parentId=void 0,a.id=0,a.status=1,a.depCode="",a.name="",a.order=1,(l=i.value)==null||l.toggle()}function D(){var l;(l=E.value)==null||l.validate().then(s=>{var r;s||((r=i.value)==null||r.close(),O.success("\u6A21\u62DF\u90E8\u95E8\u6DFB\u52A0/\u7F16\u8F91\u6210\u529F\uFF0C\u6570\u636E\u4E3A\uFF1A"+JSON.stringify(a)))}).catch(s=>{console.log("error",s)})}function B(l){var s;c.value="\u7F16\u8F91\u90E8\u95E8",Object.keys(l).forEach(r=>{a[r]=l[r]}),a.parentId=l.parentId,(s=i.value)==null||s.toggle()}return te(_),L(V({DP_CODE_FLAG:ne,formRef:E,dialogTitle:c,departmentModel:a},e),{rowKey:A,tableColumns:t,onUpdateItem:B,onDataFormConfirm:D,onDeleteItem:b,onAddItem:C,modalDialog:i})}}),de={class:"main-container"},se=p(" \u7F16\u8F91 "),re=p(" \u5220\u9664 "),ie=p("\u6B63\u5E38"),me=p("\u7981\u7528");function pe(e,t,a,E,c,A){const i=d("AddButton"),g=d("TableHeader"),_=d("a-button"),F=d("a-space"),b=d("a-table-column"),C=d("a-table"),D=d("TableBody"),B=d("a-option"),l=d("a-select"),s=d("a-form-item"),r=d("a-input"),m=d("a-input-number"),h=d("a-radio"),N=d("a-radio-group"),P=d("a-form"),R=d("ModalDialog");return f(),k("div",de,[o(D,null,{header:n(()=>[o(g,{"show-filter":!1},{"top-right":n(()=>[o(i,{onAdd:e.onAddItem},null,8,["onAdd"])]),_:1})]),default:n(()=>[o(C,{bordered:!1,loading:e.tableLoading,data:e.dataList,"row-key":e.rowKey,pagination:!1},{columns:n(()=>[(f(!0),k(w,null,T(e.tableColumns,u=>(f(),U(b,{key:u.key,align:u.align,title:u.title,width:u.width,"data-index":u.key,fixed:u.fixed},ae({_:2},[u.key==="actions"?{name:"cell",fn:n(({record:y})=>[o(F,null,{default:n(()=>[o(_,{status:"success",size:"mini",onClick:K=>e.onUpdateItem(y)},{default:n(()=>[se]),_:2},1032,["onClick"]),o(_,{status:"danger",size:"mini",onClick:K=>e.onDeleteItem(y)},{default:n(()=>[re]),_:2},1032,["onClick"])]),_:2},1024)])}:void 0]),1032,["align","title","width","data-index","fixed"]))),128))]),_:1},8,["loading","data","row-key"])]),_:1}),o(R,{ref:"modalDialog",title:e.dialogTitle,onConfirm:e.onDataFormConfirm},{content:n(()=>[o(P,{ref:"formRef",model:e.departmentModel,labelCol:{span:4}},{default:n(()=>[o(s,{label:"\u4E0A\u7EA7\u90E8\u95E8",name:"parentId"},{default:n(()=>[o(l,{modelValue:e.departmentModel.parentId,"onUpdate:modelValue":t[0]||(t[0]=u=>e.departmentModel.parentId=u),placeholder:"\u8BF7\u9009\u62E9\u4E0A\u7EA7\u90E8\u95E8"},{default:n(()=>[(f(!0),k(w,null,T(e.dataList,u=>(f(),U(B,{key:u.id,value:u.id},{default:n(()=>[p(j(u.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(s,{label:"\u90E8\u95E8\u540D\u79F0",field:"name",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",trigger:"blur"},{min:3,max:10,message:"\u957F\u5EA6\u5728 3 - 10\u4E2A\u5B57\u7B26",trigger:"blur"}],"validate-trigger":["change","input"]},{default:n(()=>[o(r,{placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u540D\u79F0",modelValue:e.departmentModel.name,"onUpdate:modelValue":t[1]||(t[1]=u=>e.departmentModel.name=u)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u90E8\u95E8\u7F16\u53F7",field:"depCode",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u90E8\u95E8\u7F16\u53F7",trigger:"blur"},{min:3,max:10,message:"\u957F\u5EA6\u5728 3 - 30\u4E2A\u5B57\u7B26",trigger:"blur"}],"validate-trigger":["change","input"]},{default:n(()=>[o(r,{placeholder:"\u8BF7\u8F93\u5165\u90E8\u95E8\u7F16\u53F7",modelValue:e.departmentModel.depCode,"onUpdate:modelValue":t[2]||(t[2]=u=>e.departmentModel.depCode=u)},{prepend:n(()=>[p(j(e.DP_CODE_FLAG),1)]),_:1},8,["modelValue"])]),_:1}),o(s,{label:"\u6392\u5E8F",name:"order"},{default:n(()=>[o(m,{modelValue:e.departmentModel.order,"onUpdate:modelValue":t[3]||(t[3]=u=>e.departmentModel.order=u)},null,8,["modelValue"])]),_:1}),o(s,{label:"\u72B6\u6001",name:"status"},{default:n(()=>[o(N,{modelValue:e.departmentModel.status,"onUpdate:modelValue":t[4]||(t[4]=u=>e.departmentModel.status=u)},{default:n(()=>[o(h,{value:1},{default:n(()=>[ie]),_:1}),o(h,{value:0},{default:n(()=>[me]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","onConfirm"])])}var ge=Q(le,[["render",pe]]);export{ge as default};
