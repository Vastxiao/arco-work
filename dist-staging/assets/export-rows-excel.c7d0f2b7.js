var I=Object.defineProperty,L=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var B=(e,a,t)=>a in e?I(e,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[a]=t,F=(e,a)=>{for(var t in a||(a={}))T.call(a,t)&&B(e,t,a[t]);if(w)for(var t of w(a))R.call(a,t)&&B(e,t,a[t]);return e},C=(e,a)=>L(e,S(a));import{_ as K,p as N,g as j}from"./index.353524b8.js";import{u as A,b as z,a as $,c as D}from"./table.11835550.js";import{d as M,a as P,e as X,r as u,o as r,g as E,j as c,m as n,F as H,N as V,c as y,as as O,O as d,P as v,M as q}from"./vendor.98fdfd48.js";import{X as _}from"./xlsx.591b6c2d.js";const G=M({name:"ExportRowsExcel",setup(){const e=P(null),a=A(),{selectedRowKeys:t,onSelectionChange:b}=z(),x=D("id"),h=$([a.indexColumn,{title:"\u540D\u79F0",key:"nickName",dataIndex:"nickName"},{title:"\u6027\u522B",key:"gender",dataIndex:"gender"},{title:"\u5730\u5740",key:"address",dataIndex:"address"},{title:"\u767B\u5F55\u65F6\u95F4",key:"lastLoginTime",dataIndex:"lastLoginTime"},{title:"\u767B\u5F55IP",key:"lastLoginIp",dataIndex:"lastLoginIp"},{title:"\u72B6\u6001",key:"status",dataIndex:"status"}]);function f(){N({url:j,data:{page:1,pageSize:20}}).then(a.handleSuccess).catch(console.log)}function g(){if(t.value.length===0){q.error("\u8BF7\u9009\u62E9\u8981\u5BFC\u51FA\u7684\u884C");return}const i=t.value.map(o=>a.dataList.find(k=>k.id===o)).map(o=>[o.nickName,o.gender===0?"\u7537":"\u5973",o.address,o.lastLoginTime,o.lastLoginIp]);i.unshift(["\u6635\u79F0","\u6027\u522B","\u5730\u5740","\u4E0A\u6B21\u767B\u5F55\u65F6\u95F4","\u4E0A\u6B21\u767B\u5F55IP"]);const p=_.utils.aoa_to_sheet(i),m=_.utils.book_new();_.utils.book_append_sheet(m,p,"\u6570\u636E\u62A5\u8868"),_.writeFile(m,"table-list.xlsx")}return X(f),C(F({tableRef:e},a),{selectedRowKeys:t,onSelectionChange:b,tableColumns:h,rowKey:x,exportExcel:g})}}),J={class:"main-container"},Q=d("\u5BFC\u51FA\u9009\u4E2D\u7684Excel ");function U(e,a,t,b,x,h){const f=u("a-button"),g=u("TableHeader"),i=u("a-avatar"),p=u("a-tag"),m=u("a-table-column"),o=u("a-table"),k=u("TableBody");return r(),E("div",J,[c(g,{"show-filter":!1},{"top-right":n(()=>[c(f,{type:"primary",size:"small",onClick:e.exportExcel},{default:n(()=>[Q]),_:1},8,["onClick"])]),_:1}),c(k,null,{default:n(()=>[c(o,{ref:"tableRef",data:e.dataList,pagination:!1,"row-key":e.rowKey,"row-selection":{selectedRowKeys:e.selectedRowKeys},onSelectionChange:e.onSelectionChange},{columns:n(()=>[(r(!0),E(H,null,V(e.tableColumns,s=>(r(),y(m,{key:s.key,align:"center",title:s.title,"data-index":s.key},O({_:2},[s.key==="index"?{name:"cell",fn:n(({rowIndex:l})=>[d(v(l+1),1)])}:s.key==="gender"?{name:"cell",fn:n(({record:l})=>[d(v(l.gender===1?"\u7537":"\u5973"),1)])}:s.key==="avatar"?{name:"cell",fn:n(({record:l})=>[c(i,{src:l.avatar},null,8,["src"])])}:s.key==="status"?{name:"cell",fn:n(({record:l})=>[l.status===1?(r(),y(p,{key:0,color:"blue",size:"small"},{default:n(()=>[d("\u6B63\u5E38")]),_:1})):(r(),y(p,{key:1,color:"red",size:"small"},{default:n(()=>[d("\u7981\u7528")]),_:1}))])}:void 0]),1032,["title","data-index"]))),128))]),_:1},8,["data","row-key","row-selection","onSelectionChange"])]),_:1})])}var te=K(G,[["render",U]]);export{te as default};
